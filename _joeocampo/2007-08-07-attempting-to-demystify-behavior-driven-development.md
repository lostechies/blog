---
wordpress_id: 41
title: Attempting to Demystify Behavior Driven Development
date: 2007-08-07T04:22:22+00:00
author: Joe Ocampo
layout: post
wordpress_guid: /blogs/joe_ocampo/archive/2007/08/07/attempting-to-demystify-behavior-driven-development.aspx
dsq_thread_id:
  - "262089332"
categories:
  - BDD (Behavior Driven Development)
  - Domain Driven Design (DDD)
redirect_from: "/blogs/joe_ocampo/archive/2007/08/07/attempting-to-demystify-behavior-driven-development.aspx/"
---
After receiving several emails and reading [Roy Osherove&#8217;s post](http://weblogs.asp.net/rosherove/archive/2007/08/04/behave-enables-behavior-driven-testing-raises-some-interesting-questions.aspx) on Behave#, I wanted to give more incite and answer some questions that were asked&nbsp;about Behave# and BDD in general. 

### What is BDD?

I am really going to do one hell of a hack job on [Behavior-Driven.org](http://behaviour-driven.org/BehaviourDrivenDevelopment) but my intentions are to draw you to the issue at hand. 

Behavior Driven Development’s (BDD) primary intent is to bring software development&#8217;s focus back to the delivery&nbsp;of business value.&nbsp; It accomplishes this by bridging the dichotomy ****between ****business requirements and **working** software into one cohesive common vocabulary called the <a href="https://lostechies.com/blogs/joe_ocampo/archive/2007/04/02/a-discussion-on-domain-driven-design.aspx" target="_blank">ubiquitous language</a>. 

> _Now it is very important to note that BDD is simply the evolution of the existing practice of Test Driven Development (TDD). A majority if not all of the principles of TDD are still applicable. BDD merely focuses on the vocabulary on which these principles are conveyed that is meaningful both to the business advocates as well as the development and testing teams._

Experienced TDD&nbsp;practitioners, particularly those that have been involved in helping other developers learn the practice are accustomed to the following epiphanies: 

  1. The developer starts writing unit tests around their code using a test framework like JUnit or NUnit. 
      * As the body of tests increases the developer begins to enjoy a strongly increased sense of confidence in their work. 
          * At some point the developer has the insight (or are shown) that writing the tests before writing the code, helps them focus on only writing the code that they need. 
              * The developer also notices that when they return to some code that they haven’t seen for a while, the tests serve to document how the code works. 
                  * A point of revelation occurs when the developer realizes that writing tests in this way helps them to “discover” the API to their code. TDD has now become a design process. 
                      * Expertise in TDD begins to dawn at the point where the developer realizes that TDD is not about testing, it is about defining behavior. 
                          * Behavior is about the interactions between components of the system and so the use of mocking is a fundamental to advanced TDD.</ol> 
                        We have observed this progression in many developers, but unfortunately while most, with a little help, find their way to step 4, many miss the big wins found at steps 5, 6 and 7. 
                        
                        OK so why are steps 5, 6, and 7 so overlooked? Because it requires an understanding of another extremely crucial discipline and that is <a href="https://lostechies.com/blogs/joe_ocampo/archive/2007/04/02/a-discussion-on-domain-driven-design.aspx" target="_blank">Domain Driven Design</a>. Domain Driven Design’s focus is to outline a set of design practices and principles centered on the business domain at hand. These practices and principles help to bring attention to the problem business domain through modeling and coding practices. 
                        
                        Agile principles and practices while not regimented require you to think and determine the best course of action in building great software. They require eXtreme self discipline as they put the power of choice in your hands. If you are putting together a picture frame, bring out the tiny framing hammer. If you are putting down rail road tracks bring out the sledge hammer. The point is,&nbsp;think! 
                        
                        As usual I digress, Think of BDD as a proverbial facade layer atop your architecture that attempts to bridge TDD, Domain Driven Design and Requirements authoring into one practice. [Scott Bellware](http://codebetter.com/blogs/scott.bellware/archive/2007/08/04/166415.aspx)’s recent post does a better job at explaining this. 
                        
                        ### So how do I use it?
                        
                        I cannot tell you enough how much I love saying what I am about to say, “It depends…” Being an Agile coach and practitioner that phrase alone has brought frustration and laughter to a majority of my customers. But the phrase truly captures the intention; it really depends on how far you want to take it. 
                        
                        Where does business software originate? Does it originate in the mind of a developer? A majority of the time software exist to serve the function of facilitating some type of business need. A lot of time that business need is often gathered by formal requirement documents, UML, etc. Sometimes developers never talk to the business (process smell). DDD captures the interaction of the development team in partnership with the business, to come up with a domain model that they both agree on, both in definition and in structure. The model is captured in the Domain Layer and forms the heart of architecture. This is where software business objects such as <a href="https://lostechies.com/blogs/joe_ocampo/archive/2007/04/02/a-discussion-on-domain-driven-design.aspx" target="_blank">Entities, Value Objects and Services</a> are born. Now notice I said business objects. As the business team and development team interact they form a common vocabulary termed the <a href="https://lostechies.com/blogs/joe_ocampo/archive/2007/04/02/a-discussion-on-domain-driven-design.aspx" target="_blank">ubiquitous language</a>. This language helps to explain how our software behaves when the user interacts with the program.&nbsp; The business team authors stories that are later elucidated by the development team and&nbsp;testers of some kind.&nbsp; These stories take on the following form.
                        
                        > [See What’s in a Story?](http://dannorth.net/whats-in-a-story/)
                        
                        From the Domain layer you capture a story&nbsp;with the business user. In fact if you can have them write the story and the acceptance test. 
                        
                        > As a savings account holder  
                        > I want to transfer money from my savings account  
                        > So that I can get cash easily from an ATM
                        
                        Create a couple of acceptance test. 
                        
                        > Scenario 1: Savings account is in credit  
                        > Given my savings account balance is: 100  
                        > And my cash account balance is: 10  
                        > When I transfer to cash account: 20  
                        > Then my savings account balance should be: 80  
                        > And my cash account balance should be: 30 
                        > 
                        > Scenario 2: Savings account is overdrawn  
                        > Given my savings account balance is: -20  
                        > And my cash account balance is: 10  
                        > When I transfer to cash account: 20  
                        > Then my savings account balance should be: -20  
                        > And my cash account balance should be: 10
                        
                        OK you have a story and some acceptance test, so you can tell when the story complete. 
                        
                        So if we were using NUnit we could write a simple unit test like this. 
                        
                        <font face="Courier New" size="2">[TestFixture]<br />public class AccountTests<br />{<br />&nbsp;&nbsp;&nbsp; [Test]<br />&nbsp;&nbsp;&nbsp; public void TransferFunds()<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Account savingsAccount = new Account(100);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Account cashAccount = new Account(10); </font> 
                        
                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savingsAccount.TransferTo(cashAccount, 10); </font> 
                        
                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.AreEqual(90, savingsAccount.Balance);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.AreEqual(20, cashAccount.Balance);<br />&nbsp;&nbsp;&nbsp; }<br />}</font> 
                        
                        Assuming you were practicing TDD you went through the steps of Red, Green and Refactor. Now you are on your way to TDD Nirvana but wait.&nbsp;You have completed your first Unit test but the problem is that it means only something to you the developer. It does not have any meaning to the business,&nbsp;all they care about is&nbsp;that the&nbsp;software working? Before I get bombarded by emails, you could be blessed with an uber business analyst that can write <a href="http://fitnesse.org/" target="_blank">FitNesse</a> fixtures. I have never been blessed with such an individual so for those that have, kudos to you! A majority of the business users I deal with love to author stories but they don’t like to work with tools that cause them to change&nbsp;their chain of thought. 
                        
                        So lets dress this up a little bit with some BDD flavor.&nbsp; Mind you we are still using NUnit! 
                        
                        <font face="Courier" size="2">[TestFixture]<br />[Category(&#8220;Account Specifications&#8221;)]<br />public class <strong>When</strong>_transferring_money_to_a_cash_account_from_a_savings_account_in_credit<br />{<br />&nbsp;&nbsp;&nbsp; private Account savingsAccount = new Account(100);<br />&nbsp;&nbsp;&nbsp; private Account cashAccount = new Account(10); </font> 
                        
                        <font face="Courier" size="2">&nbsp;&nbsp;&nbsp; [SetUp]<br />&nbsp;&nbsp;&nbsp; public void <strong>Given</strong>()<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savingsAccount = new Account(100);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cashAccount = new Account(10);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savingsAccount.TransferTo(cashAccount, 10);<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; </font>
                        
                        <font face="Courier" size="2">&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br />&nbsp;&nbsp;&nbsp; public void <strong>Then</strong>_savings_account_balance_should_be_90()<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.That(savingsAccount.Balance, Is.EqualTo(90));<br />&nbsp;&nbsp;&nbsp; }&nbsp; </font>
                        
                        <font face="Courier" size="2">&nbsp;&nbsp;&nbsp; [Test]<br />&nbsp;&nbsp;&nbsp; public void <strong>Then</strong>_cash_account_balance_should_be_20()<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.That(cashAccount.Balance, Is.EqualTo(20));<br />&nbsp;&nbsp;&nbsp; }<br />}</font> 
                        
                        As you can see this is the same test but it reads much cleaner.&nbsp; I use the class name to indicate the &#8220;When&#8221; of BDD, I then use the SetUp to&nbsp;control the contextual flow of the test fixture, the &#8220;Given&#8221;.&nbsp; SetUp actually&nbsp;means something now from a contextual flow, it sets up the &#8220;Given(s)&#8221; and invokes the &#8220;When&#8221;.&nbsp; The only&nbsp;aspect remaining&nbsp;is to assert on the behavior that _should_ happen **when** we transfer to an account. In this case the savings account balance should be 90 and the cash account balance should be 20.&nbsp; 
                        
                        > _I encourage everyone that is practicing TDD or BDD and using NUnit 2.4 or above to start using the_ <a href="https://lostechies.com/blogs/joe_ocampo/archive/2007/07/22/nunit-s-new-constraint-model.aspx" target="_blank"><em>new constraint model</em></a>_._
                        
                        So what have we achieved here?&nbsp; We have taken an existing TDD unit test and transformed it into a more meaningful representation of intent and behavior by applying the Given, When, Then constructs of BDD.&nbsp; No existing frameworks were harmed in the production of this unit test.&nbsp; Just simply a&nbsp;state of mind&nbsp;change.&nbsp; This verboseness and readability have tremendous implications as the test runner displays the following output. 
                        
                        [<img style="border-top-width: 0px;border-left-width: 0px;border-bottom-width: 0px;border-right-width: 0px" height="105" alt="image" src="https://lostechies.com/content/joeocampo/uploads/2011/03AttemptingtoDemystifyBehaviorDrivenDevel_A6FE/image_thumb.png" width="520" border="0" />](https://lostechies.com/content/joeocampo/uploads/2011/03AttemptingtoDemystifyBehaviorDrivenDevel_A6FE/image.png)&nbsp;
                        
                        Here is the same result set grouped by category.
                        
                        [<img style="border-top-width: 0px;border-left-width: 0px;border-bottom-width: 0px;border-right-width: 0px" height="78" alt="BDDRunnerOutputCatagory" src="https://lostechies.com/content/joeocampo/uploads/2011/03AttemptingtoDemystifyBehaviorDrivenDevel_A6FE/BDDRunnerOutputCatagory_thumb.png" width="508" border="0" />](https://lostechies.com/content/joeocampo/uploads/2011/03AttemptingtoDemystifyBehaviorDrivenDevel_A6FE/BDDRunnerOutputCatagory.png) 
                        
                        This is nice, I get to ask you a couple of questions.
                        
                          * What is purpose of AccountTests? 
                              * What is the test TransferFunds doing? 
                                  * What happens when you transfer money to a cash account from a savings account in credit?</ul> 
                                Hmm the last question kind of matches the behavior of the fixture perfectly! Simply magical, you can easily see that the output of your unit test have business meaning!&nbsp; They can be used to convey the behavior of your software and the business value that it is producing.&nbsp; Because most xUnit framework produce some type of XML file you can use an XSLT file to transform the raw output into something meaningful for the business.&nbsp; Do a simple underscore to space replacement and you have yourself a talking requirements document!&nbsp; I have heard of <a href="http://codebetter.com/blogs/scott.bellware/archive/2007/08/07/166503.aspx" target="_blank">tails of uber developers</a> that have managed to **_reflect_** their way to this state of nirvana by the&nbsp;source code alone&nbsp;but I have yet to see any post on such a mystical endeavor. hint hint!&nbsp; **_Update: mystical tool has been found!_**
                                
                                ### Ok this is great Joe, so why on earth would we need Behave# if we simply have to change our thought process around TDD?
                                
                                I am glad you asked!&nbsp; 
                                
                                The answer to this questions lies in the source code.&nbsp; Look again at the BDD fixture we created above.
                                
                                <font face="Courier" size="2">[TestFixture]<br />[Category(&#8220;Account Specifications&#8221;)]<br />public class <strong>When</strong>_transferring_money_to_a_cash_account_from_a_savings_account_in_credit<br />{<br />&nbsp;&nbsp;&nbsp; private Account savingsAccount = new Account(100);<br />&nbsp;&nbsp;&nbsp; private Account cashAccount = new Account(10); </font> 
                                
                                <font face="Courier" size="2">&nbsp;&nbsp;&nbsp; [SetUp]<br />&nbsp;&nbsp;&nbsp; public void <strong>Given</strong>()<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savingsAccount = new Account(100);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cashAccount = new Account(10);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savingsAccount.TransferTo(cashAccount, 10);<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; </font>
                                
                                <font face="Courier" size="2">&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br />&nbsp;&nbsp;&nbsp; public void <strong>Then</strong>_savings_account_balance_should_be_90()<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.That(savingsAccount.Balance, Is.EqualTo(90));<br />&nbsp;&nbsp;&nbsp; }&nbsp; </font>
                                
                                <font face="Courier" size="2">&nbsp;&nbsp;&nbsp; [Test]<br />&nbsp;&nbsp;&nbsp; public void <strong>Then</strong>_cash_account_balance_should_be_20()<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.That(cashAccount.Balance, Is.EqualTo(20));<br />&nbsp;&nbsp;&nbsp; }<br />}</font>
                                
                                Question time! Looking at the code above:
                                
                                  * What type of profession can author the scenario above? 
                                      * Can a business person write this? 
                                          * From a <a href="http://en.wikipedia.org/wiki/Traceability_matrix" target="_blank">traceability</a> perspective what story spawned this scenario? 
                                              * Why do these objects even exist?</ul> 
                                            Answers:
                                            
                                              * Developer 
                                                  * Not a chance 
                                                      * Don&#8217;t know? 
                                                          * Because I wrote them!</ul> 
                                                        Enter in Behave#.&nbsp; Now I have proven the <a href="https://lostechies.com/blogs/joe_ocampo/archive/2007/07/15/more-bdd-xbehave-madness.aspx" target="_blank">probability of a Business Analyst being able to use Behave#</a> don&#8217;t ask me why but it was easier to show them how to use Behave# then it was FitNesse.&nbsp; I am not taking anything away from FitNesse I am simply conveying the outcome of this ONE episode I had in teaching someone how to author a story in an IDE that had never used one.&nbsp; I will say that I have spent the last 2 years preaching about story form and acceptance test authoring, so that probably gave this Business analyst an edge over the rest of her peers.&nbsp; The code below gives you an example of how the story and scenarios fit together in Behave#.
                                                        
                                                        #### Business Authors:
                                                        
                                                        &nbsp;&nbsp;&nbsp;&nbsp;<font face="Courier New" size="2">&nbsp;&nbsp; [Test]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Transfer_to_cash_account()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Story transfer_to_cash_account = new Story(&#8220;Transfer to cash account&#8221;); </font> 
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transfer_to_cash_account.As_a(&#8220;savings account holder&#8221;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .I_want(&#8220;to transfer money from my savings account&#8221;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .So_that(&#8220;I can get cash easily from an ATM&#8221;); </font> 
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Scenario savings_account_is_in_credit = new Scenario(&#8220;savings account is in credit&#8221;); </font> 
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savings_account_is_in_credit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Given(&#8220;my savings account balance is&#8221;, 100)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .And(&#8220;my cash account balance is&#8221;, 10)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .When(&#8220;I transfer to cash account&#8221;, 20)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Then(&#8220;my savings account balance should be&#8221;, 80)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .And(&#8220;my cash account balance should be&#8221;, 30); </font> 
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savings_account_is_in_credit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Given(&#8220;my savings account balance is&#8221;, 400)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .And(&#8220;my cash account balance is&#8221;, 100)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .When(&#8220;I transfer to cash account&#8221;, 100)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Then(&#8220;my savings account balance should be&#8221;, 300)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .And(&#8220;my cash account balance should be&#8221;, 200);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font>
                                                        
                                                        <font face="Courier New" size="2"></font>&nbsp;
                                                        
                                                        #### Developer Implements&nbsp;action delegates:<font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;</font>
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [Test]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Transfer_to_cash_account()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Story transfer_to_cash_account = new Story(&#8220;Transfer to cash account&#8221;); </font>
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; transfer_to_cash_account.As_a(&#8220;savings account holder&#8221;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .I_want(&#8220;to transfer money from my savings account&#8221;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .So_that(&#8220;I can get cash easily from an ATM&#8221;); </font> 
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Account savings = null;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Account cash = null; </font> 
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Scenario savings_account_is_in_credit = new Scenario(&#8220;savings account is in credit&#8221;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savings_account_is_in_credit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Given(&#8220;my savings account balance is&#8221;, 100,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delegate(int accountBallance)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savings = new Account(accountBallance);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; })<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .And(&#8220;my cash account balance is&#8221;, 10,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delegate(int accountBallance)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cash = new Account(accountBallance);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; })<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .When(&#8220;I transfer to cash account&#8221;, 20,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delegate(int transferAmount)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savings.TransferTo(cash, transferAmount);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; })<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Then(&#8220;my savings account balance should be&#8221;, 80,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delegate(int expectedBallance)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.AreEqual(expectedBallance, savings.Ballance);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; })<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .And(&#8220;my cash account balance should be&#8221;, 30,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delegate(int expectedBallance)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.AreEqual(expectedBallance, cash.Ballance);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }); </font> 
                                                        
                                                        <font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savings_account_is_in_credit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Given(&#8220;my savings account balance is&#8221;, 400)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .And(&#8220;my cash account balance is&#8221;, 100)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .When(&#8220;I transfer to cash account&#8221;, 100)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Then(&#8220;my savings account balance should be&#8221;, 300)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .And(&#8220;my cash account balance should be&#8221;, 200);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font>
                                                        
                                                        Lets ask the questions again! Looking at the code above:
                                                        
                                                          * What type of profession can author the scenario above? 
                                                              * Can a business person write this? 
                                                                  * From a <a href="http://en.wikipedia.org/wiki/Traceability_matrix" target="_blank">traceability</a> perspective what story spawned this scenario? 
                                                                      * Why do these objects even exist?</ul> 
                                                                    Answers:
                                                                    
                                                                      * Developer possibly a business analyst of some kind.&nbsp; 
                                                                          * Maybe 
                                                                              * Story: Transfer to cash account: As a savings account holder I want to transfer money from my savings account So that I can get cash easily from an ATM 
                                                                                  * Because the preceding story and the scenario expect it.</ul> 
                                                                                As you can see Behave# manages to plug the holes that basic test fixture was missing.&nbsp; More importantly it engage the product owner(the business) to be actively involved in the story authoring process within the source code.&nbsp; Not word document or some UML diagram but the actual source code!
                                                                                
                                                                                Here are some of the questions that have been asked about Behave#:
                                                                                
                                                                                Roy Osherove&#8217;s notes and questions
                                                                                
                                                                                  1. **Would be nice to incorporate this into other frameworks like RhinoMocks, or even to non test-related frameworks, to make them self-testing.** 
                                                                                      1. _Agreed although I don&#8217;t know how Ayende may feel about it.&nbsp; But then again Rhino does mocking and Behave# does BDD.&nbsp; Think SRP on a grander scale._
                                                                                      * **You actually write your own DSL here, which is nice, but it&#8217;s still developer facing. customers can&#8217;t deal with this. too technical. I can&#8217;t help but think that this is exactly the kind of DSL that is enabled by using** [**Fitnesse along with the DoFixture**](http://codebetter.com/blogs/jeremy.miller/archive/2006/07/15/147400.aspx)**. I&#8217;m not sure duplication is a good thing here but I&#8217;m willing to live with the two in separate until something better that unites them comes along.** 
                                                                                          1. _I will have to look into the DoFixture syntax but I find it hard to believe that they took this route._
                                                                                          * **Would be nice to have a way to declare some sort of &#8220;initalizationTest&#8221; where you place all the strings with related delgates into. Wait, there is &#8211; use [SetUp]. But still feels clunky.** 
                                                                                              1. _You could to this, I even experimented with creating my own&nbsp;Acceptance test class that simply exposed static methods that mapped to the action delegate signature and performed the&nbsp;assertion.&nbsp; Anything really is possible since it simply is a closed statement block that can be implemented inline or within a class or fixture itself. You see clunky I see options.&nbsp; 🙂 You could place all the strings in the&nbsp;setup but you are thinking like a developer.&nbsp; Business analyst won&#8217;t do this but they sure love to copy and paste!_&nbsp;
                                                                                              * **Many strings also means ability to fail in use the right string: maybe use consts but then, that would defeat the purpose&#8230; not sure what the best solution here.** 
                                                                                                  1. _Agreed, I am&nbsp;spiking a simple&nbsp;distance algorithm to take care of typos or accidental space inclusion.&nbsp; This should help in that arena.&nbsp;But I firmly believe that the business analyst should be allowed to use strings, that is the power of framework.&nbsp; By holding strict to modern OOP practices we&nbsp;will hinder the authorship of the story from the business analyst perspective._
                                                                                                  * **I&#8217;m not sure that using delegates is the right way to go here. Maybe using actual method references instead of anonymous delegates is better (they are utility methods anyway. Still not sure which would be more readable.** 
                                                                                                      1. _See answer to question 3._
                                                                                                      * **using &#8220;then&#8221; and &#8220;And&#8221; means you can have multiple &#8220;Asserts&#8221; on a given scenario test. I think that also means you get** [**the problem associated with using multiple asserts in a single test**](http://www.google.com/url?sa=t&ct=res&cd=1&url=http%3A%2F%2Fweblogs.asp.net%2Frosherove%2Farchive%2F2005%2F04%2F14%http://weblogs.asp.net/rosherove/archive/2005/04/14/AvoidMultipleAsserts.aspx)**. I&#8217;m not sure if the frameworks helps &#8220;swallow&#8221; exceptions and moves on to the next asserts or if each exception blows up the entire test.&nbsp;( so if line 21 throws an exception , will line 22 ever execute?)** 
                                                                                                          1. _At this time no it will not ever reach line 22 but the intention is that the stacktrace is written in such a verbose manner that it will logically bring the developer to the point of contention and solve this issue as it relates to the context of scenario being exercised._
                                                                                                          * **I think this syntax will be largely unreadable in VB.NET, which is much more verbose.** 
                                                                                                              1. _With the exception of underscores the authoring should be fairly easy but I do agree that wiring up the delegate will not be as elegant.&nbsp; I have an idea stop using VB.Net.&nbsp; Just kidding but I strongly encourage VB.Neters to switch to C# or if you like your code switch to IronRuby!._
                                                                                                              * **Maybe there cold be a tool who would let you write these sentences in excel and then &#8220;transfer&#8221; them into c# code. that&#8217;d be awesome. especially if it was automatic. that might be the bridge to fitnesse I&#8217;m looking for.** 
                                                                                                                  1. _Funny you should ask.&nbsp; This is the first time I am going to say this so I am kind of disappointed that it is buried in here but it should answer your question.&nbsp; My thought was to contact&nbsp;Dan North and other BDD practioners to come up with an XSD that can carry the information of defining Stories, Scenarios, and Actions.&nbsp; This meta data would then becomes a lightweight payload that can be shared between other applications.&nbsp; Imagine, now you could create you own story authoring template in Word, Excel , you could even imbed a rich text box in your favorite agile project management tool and export the information to a validation framework such as behave# or what ever parser you would like.&nbsp; Again this is conceptual thought but I am sure you see the potential._
                                                                                                                  * **Developers who are already used to the NUnit syntax might dislike this syntax or &#8220;not get it&#8221;** 
                                                                                                                      1. _Agreed that the BDD syntax takes a while to get use to but so did TDD.&nbsp; I read somewhere we should Embrace&nbsp;Change and be courageous. 🙂&nbsp;_
                                                                                                                      * **People might think that these tests are not instead of other unit tests &#8211; &#8220;More tests to write??&#8221;** 
                                                                                                                          1. _Like any other practice this is going to take time and I don&#8217;t want anyone to throw away there existing test suite to write them over in a BDD context.&nbsp; Take for instance where I work.&nbsp; We have over 6000 unit test covering our solution.&nbsp; Do you honestly think we are going to change all of them, no.&nbsp; What we are doing is any enhancements or refactorings that are being accomplished are being written in BDD syntax.&nbsp; I made a special point to tell my development staff not to move to BDD unless they felt completely comfortable or were pairing with someone who had already done this.&nbsp; Like all agile practices it is organically taking shape and proliferating itself throughout the development team.&nbsp; But to your point, yes they did think at first that they were going to have to write more tests and in fact they have but they are amazed that they can actually find meaning in the code now._
                                                                                                                          * **People may not know when to use Behave# over regular unit tests &#8211; there should be some simple guidelines on when to use which.** 
                                                                                                                              1. _Agreed, the most logical place to start using Behave# is at the Domain Model layer.&nbsp; Simply because it lends itself to defining the behavior of the domain model as it relates to stories and scenarios.&nbsp; It can be used at lower level layers but I have found confusion amongst developers when pursuing it at that level.&nbsp; I don&#8217;t think it is particular to behave# as much as it is to BDD in general.&nbsp; I would consider Behave# to be more of an acceptance testing framework (at this time) simply because of cultural barriers._
                                                                                                                              * **Still today, many developers are not comfortable with using anonymous delegates.** 
                                                                                                                                  1. _Hmmm&#8230;Since they have been around since version 2.0 I am astonished especially since allot of the generic constructs in C# 2.0 depend on them.&nbsp; Not to mention 3.5 Lambda expressions.&nbsp; <a href="http://grabbagoft.blogspot.com/2007/08/addressing-some-behave-concerns.html" target="_blank">Jimmy pointed out to me</a> that when 3.5 comes out we can simply overload the action<t> delegates with funct<t> and use Lambda expressions as well.&nbsp; I had no clue about developers being uncomfortable though.&nbsp; Do you know why they are not comfortable with them?_
                                                                                                                                  * **afraid to use it since its so new and only one developer supports it.** 
                                                                                                                                      1. _JUnit and NUnit were new at one point.&nbsp; 🙂&nbsp; Update: About the one developer <a href="http://grabbagoft.blogspot.com/" target="_blank">Jimmy Bogard</a> has had a huge impact on this project.&nbsp; So as of today the developer contribution is 2.&nbsp; Like Jimmy mentions more than one == Open Source Support.&nbsp; 🙂_
                                                                                                                                      * **Is BDD testing just unit testing with a more &#8220;natural&#8221; syntax? Right now it seems to be.** 
                                                                                                                                          1. _Partly correct but so much more. Hopefully if you are still reading this I have answered this question in the sections entitled &#8220;what is BDD&#8221; and &#8220;How do I use it.&#8221;_
                                                                                                                                          * **Should BDD separate into developer-facing and customer-facing tests? (behave# vs. fitnesse)** 
                                                                                                                                              1. _No No No&#8230;I don&#8217;t want to have a separation of concern any longer. Behave# should be seen as a starting point within the actual code implementation._
                                                                                                                                              * **If not, how do we combine these?** 
                                                                                                                                                  1. _Use Behave#_
                                                                                                                                                  * **it seems that BDD can be used bot for unit testing and integration testing. It blurs the lines between traditional unit testing concepts and integration tests, or, just gives some sort of unified language to do both. it&#8217;s still up to us to decide what kind of test we&#8217;d like to write.** 
                                                                                                                                                      1. _Exactly_**!**
                                                                                                                                                      * **What types of tests is BDD not good for?** 
                                                                                                                                                          1. _I can&#8217;t think of any.&nbsp; For the most part all test have a context and an assertion on the correct or incorrect behavior of that context._</ol>